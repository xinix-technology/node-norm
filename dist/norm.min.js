!function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=30)}([function(t,e,s){const i=s(11);t.exports=class{constructor(t){this.name=t,this.rawFilters=[],this.filters=[],this.attributes={}}set(t,e){return this.attributes[t]=e,this}get(t){return this.attributes[t]}filter(...t){return t.forEach(t=>{try{t=i.tokenize(t)}catch(t){}this.rawFilters.push(t),this.filters.push(i.get(t))}),this}execFilter(t,{session:e,row:s,schema:i}){"string"==typeof t&&(t=t.trim());let r=this;return this.filters.reduce(async(t,n)=>n(await t,{session:e,row:s,schema:i,field:r}),t)}attach(t){return""===t||null==t?null:t}serialize(t){return t}compare(t,e){return void 0===e&&(e=null),t===e?0:null===t?1:t>e?-1:1}indexOf(t,e){return t.indexOf(e)}}},function(t,e){t.exports=function(t){return async function(e=null,{session:s,field:{name:i}}){if(null===e||""===e)return null;let r=new Error(`Field ${i} values must be ${t}`);if(!Array.isArray(e))throw r;try{let n=s.getSchema(t);await Promise.all(e.map(t=>n.filter(t,{session:s}))),e=e.map(t=>n.attach(t))}catch(r){throw console.error(`Caught error at nested model, ${r.stack}`),new Error(`Field ${i} must be compatible to '${t}'`)}return e}}},function(t,e){t.exports=function(t){return function(e=null){return e||t}}},function(t,e){t.exports=function(){return function(t=null,{field:{name:e}}){if(null===t||""===t)return null;t=t.toLowerCase();let s=new Error(`Field ${e} must be valid email`);const i=t.split("@");if(2!==i.length)throw s;const r=i.pop();let n=i.join("@");if("gmail.com"!==r&&"googlemail.com"!==r||(n=n.replace(/\./g,"").toLowerCase()),n.length>64||r.length>256)throw s;return t}}},function(t,e){t.exports=function(...t){return function(e=null,{field:{name:s}}){if(null===e||""===e)return null;if(-1===t.indexOf(e))throw new Error(`Field ${s} out of enum range`);return e}}},function(t,e){t.exports=function(t,e="id"){return async function(s,{session:i,field:{name:r}}){if(null===s||""===s)return null;let n={};if(n[e]=s,!await i.factory(t,n).single())throw new Error(`Field ${r} must be exists`);return s}}},function(t,e){t.exports=function(){return function(t,{field:{name:e}}){if(!t||Array.isArray(t)&&t.length)throw new Error(`Field ${e} must not empty`);return t}}},function(t,e){t.exports=function(t){return async function(e,{row:s,session:i,field:{name:r}}){if(null===e||""===e)return null;let n={[r]:e},o=await i.factory(t,n).single();if(o&&o.id!==s.id)throw new Error(`Field ${r} already exists in ${t}`);return e}}},function(t,e){t.exports=function(){return function(t=null,{field:{name:e="unknown"}}){if(null===t||""===t)throw new Error(`Field ${e} is required`);return t}}},function(t,e){t.exports=function(t,e){return function(s=null,{session:i,row:r,field:{name:n="unknown"}}){if(r[t]===e&&(null===s||""===s))throw new Error(`Field ${n} is required`);return s}}},function(t,e){t.exports=function(){return async function(t,{row:e,session:s,schema:i,field:{name:r}}){if(null===t||""===t)return null;let n={[r]:t},o=await s.factory(i.name,n).single();if(o&&o.id!==e.id)throw new Error(`Field ${r} must be unique`);return t}}},function(t,e,s){let i={};class r{static tokenize(t){if("string"!=typeof t)throw new Error("Cannot tokenize non-string filter signature");let[e,...s]=t.split(":");return s=0===(s=s.join(":")).length?[]:s.split(","),[e,...s]}static get(t){let e=typeof t;if("function"===e)return t;if("string"===e&&(t=r.tokenize(t)),!Array.isArray(t))throw new Error(`Unknown filter by ${e}`);let[n,...o]=t;if(n in i==!1)try{i[n]=s(13)("./"+n)}catch(t){i[n]=null}if(!i[n]){let s="unknown";try{s=JSON.stringify(t)}catch(t){}throw new Error(`Filter ${n} not found <${e}(${s})>`)}return i[n](...o)}static put(t,e){i[t]=e}static reset(){i={}}}t.exports=r},function(t,e){t.exports=class{constructor({name:t}){this.name=t,this._hasTx=!1}async begin(){this._hasTx||(await this._begin(),this._hasTx=!0)}async commit(){this._hasTx&&(await this._commit(),this._hasTx=!1)}async rollback(){this._hasTx&&(await this._rollback(),this._hasTx=!1)}_begin(){}_commit(){}_rollback(){}}},function(t,e,s){var i={"./are":1,"./are.js":1,"./default":2,"./default.js":2,"./email":3,"./email.js":3,"./enum":4,"./enum.js":4,"./exists":5,"./exists.js":5,"./notEmpty":6,"./notEmpty.js":6,"./notExists":7,"./notExists.js":7,"./required":8,"./required.js":8,"./requiredIf":9,"./requiredIf.js":9,"./unique":10,"./unique.js":10};function r(t){var e=n(t);return s(e)}function n(t){var e=i[t];if(!(e+1)){var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}return e}r.keys=function(){return Object.keys(i)},r.resolve=n,t.exports=r,r.id=13},function(t,e,s){const i=s(12),r=s(15);class n extends i{constructor(t){super(t),this.data=t.data||{}}load(t,e=(()=>{})){let s=this.data[t.schema.name]||[],{criteria:i,sorts:r}=t;if(s=s.filter(e=>this._matchCriteria(i,e,t.schema)),r){let t=Object.keys(r);s=s.sort((e,s)=>{let i=0;return t.forEach((n,o)=>{let a=r[n],c=Math.pow(2,t.length-o-1)*a;e[n]<s[n]?i-=c:e[n]>s[n]&&(i+=c)}),i})}return t.offset<0?s:(s=t.length<0?s.slice(t.offset):s.slice(t.offset,t.offset+t.length)).map(t=>(e(t),t))}insert(t,e=(()=>{})){const s=this.data[t.schema.name]=this.data[t.schema.name]||[];return t.rows.reduce((i,n)=>{let o={id:r()};for(let e in n)o[e]=t.schema.getField(e).serialize(n[e]);return s.push(o),e(o),++i},0)}update(t){let e=Object.keys(t.sets);return this.load(t).reduce((s,i)=>{return e.filter(e=>i[e]!==t.sets[e]&&(i[e]=t.schema.getField(e).serialize(t.sets[e]),!0)).length&&s++,s},0)}drop(t){delete this.data[t.schema.name]}truncate(t){this.data[t.schema.name]=[]}delete(t){const e=this.data[t.schema.name]=this.data[t.schema.name]||[];this.load(t).forEach(t=>{const s=e.indexOf(t);s>=0&&e.splice(s,1)})}async count(t,e){let{length:s,offset:i}=t;e||(t.offset=0,t.length=-1);let r=0;return await this.load(t,()=>r++),t.offset=i,t.length=s,r}_matchCriteria(t,e,s){if(!t)return!0;for(let i in t){let r=t[i],[n,o="eq"]=i.split("!"),a=s.getField(n),c=e[n];switch(o){case"or":{let t=!1;for(let i of r){if(this._matchCriteria(i,e,s)){t=!0;break}}if(!t)return!1;break}case"and":for(let t of r)if(!this._matchCriteria(t,e,s))return!1;break;case"eq":if(0!==a.compare(r,c))return!1;break;case"ne":if(0===a.compare(r,c))return!1;break;case"gt":if(a.compare(r,c)<=0)return!1;break;case"gte":if(a.compare(r,c)<0)return!1;break;case"lt":if(a.compare(r,c)>=0)return!1;break;case"lte":if(a.compare(r,c)>0)return!1;break;case"in":if(-1===a.indexOf(r,c))return!1;break;case"nin":if(-1!==a.indexOf(r,c))return!1;break;case"like":{let t=new RegExp(r);if(!c.match(t))return!1;break}case"regex":if(!c.match(r))return!1;break;case"where":if(!r(c,e))return!1;break;default:throw new Error(`Operator '${o}' is not implemented yet!`)}}return!0}}if("undefined"!=typeof window){let t=window.norm;if(!t)throw new Error("Norm is not defined yet!");t.adapters=t.adapters||{},t.adapters.Memory=n}t.exports=n},function(t,e,s){var i=s(16),r=s(17);t.exports=function(t,e,s){var n=e&&s||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var a=0;a<16;++a)e[n+a]=o[a];return e||r(o)}},function(t,e){var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var i=new Uint8Array(16);t.exports=function(){return s(i),i}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}},function(t,e){for(var s=[],i=0;i<256;++i)s[i]=(i+256).toString(16).substr(1);t.exports=function(t,e){var i=e||0,r=s;return[r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]]].join("")}},function(t,e,s){"use strict";class i{constructor(t){this._state=i.PENDING,this._resolve=void 0,this._reject=void 0,this._promise=new t((t,e)=>{this._resolve=t,this._reject=e})}get state(){return this._state}get promise(){return this._promise}reject(t){this._state===i.PENDING&&(this._state=i.REJECTED,this._reject(t))}resolve(t){this._state===i.PENDING&&(this._state=i.FULFILLED,this._resolve(t))}}i.PENDING="PENDING",i.FULFILLED="FULFILLED",i.REJECTED="REJECTED",t.exports=i},function(t,e,s){"use strict";const i=s(24),r=s(25);t.exports=class{constructor(){this._list=new i}shift(){if(0===this.length)return;const t=this._list.head;return this._list.remove(t),t.data}unshift(t){const e=i.createNode(t);this._list.insertBeginning(e)}push(t){const e=i.createNode(t);this._list.insertEnd(e)}pop(){if(0===this.length)return;const t=this._list.tail;return this._list.remove(t),t.data}[Symbol.iterator](){return new r(this._list)}iterator(){return new r(this._list)}reverseIterator(){return new r(this._list,!0)}get head(){if(0!==this.length)return this._list.head.data}get tail(){if(0!==this.length)return this._list.tail.data}get length(){return this._list.length}}},function(t,e,s){const i=s(0);t.exports=class extends i{attach(t){if(null===(t=super.attach(t)))return null;if("string"!=typeof t||isNaN(t)||(t=Number(t)),"number"==typeof t){let e=new Date;return e.setTime(t),e}let e=new Date(t);if(isNaN(e.getTime()))throw new Error("Invalid datetime value");return e}}},function(t,e,s){const i=s(0);t.exports=class extends i{}},function(t,e,s){const i=s(32),r=s(27);let n=0;t.exports=class{constructor(t){let{name:e,adapter:r=s(14),schemas:o=[],min:a=1,max:c=2}=t;this.name=e||`pool-${n++}`,this.schemas={},o.forEach(t=>this.putSchema(t));const l=r;Object.defineProperty(this,"_pool",{enumerable:!1,writable:!1,configurable:!1,value:i.createPool({create:()=>new l(t),async destroy(t){t.end&&await t.end()}},{min:a,max:c})})}putSchema({name:t,fields:e,observers:s,modelClass:i}){let n=this.name;return this.schemas[t]=new r({connection:n,name:t,fields:e,observers:s,modelClass:i}),this}getSchema(t){return this.schemas[t]||this.putSchema({name:t}),this.schemas[t]}acquire(...t){return this._pool.acquire(...t)}release(...t){return this._pool.release(...t)}drain(...t){return this._pool.drain(...t)}clear(...t){return this._pool.clear(...t)}}},function(t,e,s){"use strict";t.exports=class{evict(t,e,s){const i=Date.now()-e.lastIdleTime;return t.softIdleTimeoutMillis>0&&t.softIdleTimeoutMillis<i&&t.min<s||t.idleTimeoutMillis<i}}},function(t,e,s){"use strict";t.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}insertBeginning(t){null===this.head?(this.head=t,this.tail=t,t.prev=null,t.next=null,this.length++):this.insertBefore(this.head,t)}insertEnd(t){null===this.tail?this.insertBeginning(t):this.insertAfter(this.tail,t)}insertAfter(t,e){e.prev=t,e.next=t.next,null===t.next?this.tail=e:t.next.prev=e,t.next=e,this.length++}insertBefore(t,e){e.prev=t.prev,e.next=t,null===t.prev?this.head=e:t.prev.next=e,t.prev=e,this.length++}remove(t){null===t.prev?this.head=t.next:t.prev.next=t.next,null===t.next?this.tail=t.prev:t.next.prev=t.prev,t.prev=null,t.next=null,this.length--}static createNode(t){return{prev:null,next:null,data:t}}}},function(t,e,s){"use strict";const i=s(43);t.exports=class extends i{next(){const t=super.next();return t.value&&(t.value=t.value.data),t}}},function(t,e,s){"use strict";const i=s(44);t.exports=class{constructor(t){this._size=Math.max(0|+t,1),this._slots=[];for(let t=0;t<this._size;t++)this._slots.push(new i)}get length(){let t=0;for(let e=0,s=this._slots.length;e<s;e++)t+=this._slots[e].length;return t}enqueue(t,e){(e=e&&0|+e||0)&&(e<0||e>=this._size)&&(e=this._size-1),this._slots[e].push(t)}dequeue(){for(let t=0,e=this._slots.length;t<e;t+=1)if(this._slots[t].length)return this._slots[t].shift()}get head(){for(let t=0,e=this._slots.length;t<e;t+=1)if(this._slots[t].length>0)return this._slots[t].head}get tail(){for(let t=this._slots.length-1;t>=0;t--)if(this._slots[t].length>0)return this._slots[t].tail}}},function(t,e,s){const i=s(46),r=s(28),n=s(0),o=s(47);t.exports=class{constructor({name:t,fields:e=[],observers:s=[],modelClass:i=r}){if(!t)throw new Error("Schema name is required");this.name=t,this.fields=e,this.observers=[],this.modelClass=i,this.attributes={},s.forEach(t=>this.addObserver(t))}set(t,e){return this.attributes[t]=e,this}get(t){return this.attributes[t]}getField(t){return this.fields.find(e=>e.name===t)||new n(t)}addField(t){this.fields.find(e=>e.name===t.name)||this.fields.push(t)}addObserver(t){"initialize"in t&&t.initialize(this),this.observers.push(t)}attach(t,e=!1){let s=this.modelClass;return this.fields.forEach(s=>{switch(t[s.name]){case void 0:e||(t[s.name]=null);break;case null:t[s.name]=null;break;default:t[s.name]=s.attach(t[s.name])}}),new s(t)}observe(t,e){if(!this._observerRunner){let t=this.observers.map(t=>(e,s)=>"function"!=typeof t[e.query.mode]?s():t[e.query.mode](e,s));this._observerRunner=o(t)}return this._observerRunner(t,e)}async filter(t,{session:e,partial:s=!1}){const r=new i;if(!t)throw r.add(new Error("Cannot filter empty row")),r;if(await Promise.all(this.fields.map(async i=>{try{if(s&&void 0===t[i.name])return;t[i.name]=await i.execFilter(t[i.name],{session:e,row:t,schema:this})}catch(t){t.field=i,r.add(t)}})),!r.empty())throw r;return t}}},function(t,e){t.exports=class{constructor(t){for(let e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&(this[e]=t[e])}}},function(t,e){class s{constructor(t){if(t instanceof s)return this.session=t.session,this.connection=t.connection,this.schema=t.schema,this.find(t.criteria),this.length=t.length,this.offset=t.offset,void(this.sorts=t.sorts);let{session:e,schema:i,criteria:r}=t;this.session=e,[this.connection,this.schema]=this.session.parseSchema(i),this.find(r),this.rows=[],this.sets={},this.length=-1,this.offset=0,this.sorts=void 0}clone(){return new s(this)}find(t={}){return this.criteria="object"==typeof t?t:{id:t},this}insert(t){return this.mode="insert",this.rows.push(this.schema.attach(t)),this}sort(t){return this.sorts=t,this}limit(t){return this.length=t,this}skip(t){return this.offset=t,this}set(t){return this.mode="update",this.sets=this.schema.attach(t,!0),this}async delete({observer:t=!0}={}){this.mode="delete";let e={query:this};return t?await this.schema.observe(e,t=>this._delete(t)):await this._delete(e),e.result}async _delete(){const t=await this.session.acquire(this.connection);return await t.delete(this)}async save({filter:t=!0,observer:e=!0}={}){let s={query:this,filter:t};return e?await this.schema.observe(s,t=>this._save(t)):await this._save(s),this}async _save(t){const e=await this.session.acquire(this.connection);let{session:s}=this,{filter:i}=t;if(this.rows.length){i&&await Promise.all(this.rows.map(t=>this.schema.filter(t,{session:s})));let t=[];this.affected=await e.insert(this,e=>t.push(this.schema.attach(e))),this.rows=t}else{if(i){let t=!0;await this.schema.filter(this.sets,{session:s,partial:t})}if(0===Object.keys(this.sets).length)throw new Error("Neither insert and update to save");this.affected=await e.update(this)}}async drop(){const t=await this.session.acquire(this.connection);return await t.drop(this)}async truncate(){const t=await this.session.acquire(this.connection);return await t.truncate(this)}async all(){let t=[];const e=await this.session.acquire(this.connection);return await e.load(this,e=>t.push(this.schema.attach(e))),t}async count(t=!1){const e=await this.session.acquire(this.connection);if("function"!=typeof e.count)throw new Error("Connection does not implement method count");return e.count(this,t)}async single(){let[t]=await this.limit(1).all();return t}getInsertedRows(){return this.rows}}t.exports=s},function(t,e,s){const i=s(31),r=s(11),n=s(12),o=s(22),a=s(28),c=s(27),l=s(50),u={Manager:i,Connection:n,Model:a,Pool:o,Query:s(29),Filter:r,Schema:c,schemas:l};"undefined"!=typeof window&&(window.norm=u),t.exports=u},function(t,e,s){const i=s(22),r=s(48);class n{static adapter(t){if("function"==typeof t)return t;throw new Error("Adapter must be a constructor")}constructor({connections:t=[]}={}){this.pools={},this.main="",t.forEach(t=>this.putPool(t))}putPool(t){t.adapter=n.adapter(t.adapter);let e=new i(t);return this.pools[e.name]=e,this.main=t.main?e.name:this.main||e.name,this}getPool(t){if(""===this.main&&this.putPool({}),t=`${t||this.main}`,!this.pools[t])throw new Error(`Pool '${t}' not found`);return this.pools[t]}async runSession(t,e){const s=this.openSession(e);try{const e=await t(s);return await s.close(),await s.dispose(),e}catch(t){throw await s.dispose(),t}}openSession(t){return new r({manager:this,options:t})}async end(){await Promise.all(Object.keys(this.pools).map(async t=>{let e=this.pools[t];await e.drain(),await e.clear()})),this.pools={}}}t.exports=n},function(t,e,s){const i=s(33),r=s(19),n=s(26),o=s(23);t.exports={Pool:i,Deque:r,PriorityQueue:n,DefaultEvictor:o,createPool:function(t,e){return new i(o,r,n,t,e)}}},function(t,e,s){"use strict";const i=s(34).EventEmitter,r=s(35),n=s(36),o=s(38),a=s(40),c=s(41),l=(s(23),s(19),s(18)),u=(s(26),s(25),s(45).reflector),h="factoryCreateError",f="factoryDestroyError";t.exports=class extends i{constructor(t,e,s,i,o){super(),r(i),this._config=new n(o),this._Promise=this._config.Promise,this._factory=i,this._draining=!1,this._started=!1,this._waitingClientsQueue=new s(this._config.priorityRange),this._factoryCreateOperations=new Set,this._factoryDestroyOperations=new Set,this._availableObjects=new e,this._testOnBorrowResources=new Set,this._testOnReturnResources=new Set,this._validationOperations=new Set,this._allObjects=new Set,this._resourceLoans=new Map,this._evictionIterator=this._availableObjects.iterator(),this._evictor=new t,this._scheduledEviction=null,!0===this._config.autostart&&this.start()}_destroy(t){t.invalidate(),this._allObjects.delete(t);const e=this._factory.destroy(t.obj),s=this._Promise.resolve(e);this._trackOperation(s,this._factoryDestroyOperations).catch(t=>{this.emit(f,t)}),this._ensureMinimum()}_testOnBorrow(){if(this._availableObjects.length<1)return!1;const t=this._availableObjects.shift();t.test(),this._testOnBorrowResources.add(t);const e=this._factory.validate(t.obj),s=this._Promise.resolve(e);return this._trackOperation(s,this._validationOperations).then(e=>{if(this._testOnBorrowResources.delete(t),!1===e)return t.invalidate(),this._destroy(t),void this._dispense();this._dispatchPooledResourceToNextWaitingClient(t)}),!0}_dispatchResource(){if(this._availableObjects.length<1)return!1;const t=this._availableObjects.shift();return this._dispatchPooledResourceToNextWaitingClient(t),!1}_dispense(){const t=this._waitingClientsQueue.length;if(t<1)return;const e=t-this._potentiallyAllocableResourceCount,s=Math.min(this.spareResourceCapacity,e);for(let t=0;s>t;t++)this._createResource();if(!0===this._config.testOnBorrow){const e=t-this._testOnBorrowResources.size,s=Math.min(this._availableObjects.length,e);for(let t=0;s>t;t++)this._testOnBorrow()}if(!1===this._config.testOnBorrow){const e=Math.min(this._availableObjects.length,t);for(let t=0;e>t;t++)this._dispatchResource()}}_dispatchPooledResourceToNextWaitingClient(t){const e=this._waitingClientsQueue.dequeue();if(void 0===e||e.state!==l.PENDING)return this._addPooledResourceToAvailableObjects(t),!1;const s=new a(t,this._Promise);return this._resourceLoans.set(t.obj,s),t.allocate(),e.resolve(t.obj),!0}_trackOperation(t,e){return e.add(t),t.then(s=>(e.delete(t),this._Promise.resolve(s)),s=>(e.delete(t),this._Promise.reject(s)))}_createResource(){const t=this._factory.create(),e=this._Promise.resolve(t);this._trackOperation(e,this._factoryCreateOperations).then(t=>(this._handleNewResource(t),null)).catch(t=>{this.emit(h,t),this._dispense()})}_handleNewResource(t){const e=new c(t);this._allObjects.add(e),this._dispatchPooledResourceToNextWaitingClient(e)}_ensureMinimum(){if(!0===this._draining)return;const t=this._config.min-this._count;for(let e=0;e<t;e++)this._createResource()}_evict(){const t=Math.min(this._config.numTestsPerEvictionRun,this._availableObjects.length),e={softIdleTimeoutMillis:this._config.softIdleTimeoutMillis,idleTimeoutMillis:this._config.idleTimeoutMillis,min:this._config.min};for(let s=0;s<t;){const t=this._evictionIterator.next();if(!0===t.done&&this._availableObjects.length<1)return void this._evictionIterator.reset();if(!0===t.done&&this._availableObjects.length>0){this._evictionIterator.reset();continue}const i=t.value,r=this._evictor.evict(e,i,this._availableObjects.length);s++,!0===r&&(this._evictionIterator.remove(),this._destroy(i))}}_scheduleEvictorRun(){this._config.evictionRunIntervalMillis>0&&(this._scheduledEviction=setTimeout(()=>{this._evict(),this._scheduleEvictorRun()},this._config.evictionRunIntervalMillis))}_descheduleEvictorRun(){this._scheduledEviction&&clearTimeout(this._scheduledEviction),this._scheduledEviction=null}start(){!0!==this._draining&&!0!==this._started&&(this._started=!0,this._scheduleEvictorRun(),this._ensureMinimum())}acquire(t){if(!1===this._started&&!1===this._config.autostart&&this.start(),this._draining)return this._Promise.reject(new Error("pool is draining and cannot accept work"));if(this.spareResourceCapacity<1&&this._availableObjects.length<1&&void 0!==this._config.maxWaitingClients&&this._waitingClientsQueue.length>=this._config.maxWaitingClients)return this._Promise.reject(new Error("max waitingClients count exceeded"));const e=new o(this._config.acquireTimeoutMillis,this._Promise);return this._waitingClientsQueue.enqueue(e,t),this._dispense(),e.promise}use(t){return this.acquire().then(e=>t(e).then(t=>(this.release(e),t),t=>{throw this.release(e),t}))}isBorrowedResource(t){return this._resourceLoans.has(t)}release(t){const e=this._resourceLoans.get(t);if(void 0===e)return this._Promise.reject(new Error("Resource not currently part of this pool"));this._resourceLoans.delete(t),e.resolve();const s=e.pooledResource;return s.deallocate(),this._addPooledResourceToAvailableObjects(s),this._dispense(),this._Promise.resolve()}destroy(t){const e=this._resourceLoans.get(t);if(void 0===e)return this._Promise.reject(new Error("Resource not currently part of this pool"));this._resourceLoans.delete(t),e.resolve();const s=e.pooledResource;return s.deallocate(),this._destroy(s),this._dispense(),this._Promise.resolve()}_addPooledResourceToAvailableObjects(t){t.idle(),!0===this._config.fifo?this._availableObjects.push(t):this._availableObjects.unshift(t)}drain(){return this._draining=!0,this.__allResourceRequestsSettled().then(()=>this.__allResourcesReturned()).then(()=>{this._descheduleEvictorRun()})}__allResourceRequestsSettled(){return this._waitingClientsQueue.length>0?u(this._waitingClientsQueue.tail.promise):this._Promise.resolve()}__allResourcesReturned(){const t=Array.from(this._resourceLoans.values()).map(t=>t.promise).map(u);return this._Promise.all(t)}clear(){const t=Array.from(this._factoryCreateOperations).map(u);return this._Promise.all(t).then(()=>{for(const t of this._availableObjects)this._destroy(t);const t=Array.from(this._factoryDestroyOperations).map(u);return this._Promise.all(t)})}get _potentiallyAllocableResourceCount(){return this._availableObjects.length+this._testOnBorrowResources.size+this._testOnReturnResources.size+this._factoryCreateOperations.size}get _count(){return this._allObjects.size+this._factoryCreateOperations.size}get spareResourceCapacity(){return this._config.max-(this._allObjects.size+this._factoryCreateOperations.size)}get size(){return this._count}get available(){return this._availableObjects.length}get borrowed(){return this._resourceLoans.size}get pending(){return this._waitingClientsQueue.length}get max(){return this._config.max}get min(){return this._config.min}}},function(t,e,s){"use strict";var i,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(t,e,s){return Function.prototype.apply.call(t,e,s)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function u(t,e,s,i){var r,n,o,a;if("function"!=typeof s)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s);if(void 0===(n=t._events)?(n=t._events=Object.create(null),t._eventsCount=0):(void 0!==n.newListener&&(t.emit("newListener",e,s.listener?s.listener:s),n=t._events),o=n[e]),void 0===o)o=n[e]=s,++t._eventsCount;else if("function"==typeof o?o=n[e]=i?[s,o]:[o,s]:i?o.unshift(s):o.push(s),(r=l(t))>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return t}function h(t,e,s){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:s},r=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,n(this.listener,this.target,t))}.bind(i);return r.listener=s,i.wrapFn=r,r}function f(t,e,s){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?s?[r.listener||r]:[r]:s?function(t){for(var e=new Array(t.length),s=0;s<e.length;++s)e[s]=t[s].listener||t[s];return e}(r):m(r,r.length)}function d(t){var e=this._events;if(void 0!==e){var s=e[t];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function m(t,e){for(var s=new Array(e),i=0;i<e;++i)s[i]=t[i];return s}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=r[t];if(void 0===c)return!1;if("function"==typeof c)n(c,this,e);else{var l=c.length,u=m(c,l);for(s=0;s<l;++s)n(u[s],this,e)}return!0},a.prototype.addListener=function(t,e){return u(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return u(this,t,e,!0)},a.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,h(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,h(this,t,e)),this},a.prototype.removeListener=function(t,e){var s,i,r,n,o;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(i=this._events))return this;if(void 0===(s=i[t]))return this;if(s===e||s.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,s.listener||e));else if("function"!=typeof s){for(r=-1,n=s.length-1;n>=0;n--)if(s[n]===e||s[n].listener===e){o=s[n].listener,r=n;break}if(r<0)return this;0===r?s.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(s,r),1===s.length&&(i[t]=s[0]),void 0!==i.removeListener&&this.emit("removeListener",t,o||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,s,i;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[t]),this;if(0===arguments.length){var r,n=Object.keys(s);for(i=0;i<n.length;++i)"removeListener"!==(r=n[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=s[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},a.prototype.listeners=function(t){return f(this,t,!0)},a.prototype.rawListeners=function(t){return f(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(t,e){t.exports=function(t){if("function"!=typeof t.create)throw new TypeError("factory.create must be a function");if("function"!=typeof t.destroy)throw new TypeError("factory.destroy must be a function");if(void 0!==t.validate&&"function"!=typeof t.validate)throw new TypeError("factory.validate must be a function")}},function(t,e,s){"use strict";const i=s(37);t.exports=class{constructor(t){const e=new i;t=t||{},this.fifo="boolean"==typeof t.fifo?t.fifo:e.fifo,this.priorityRange=t.priorityRange||e.priorityRange,this.testOnBorrow="boolean"==typeof t.testOnBorrow?t.testOnBorrow:e.testOnBorrow,this.testOnReturn="boolean"==typeof t.testOnReturn?t.testOnReturn:e.testOnReturn,this.autostart="boolean"==typeof t.autostart?t.autostart:e.autostart,t.acquireTimeoutMillis&&(this.acquireTimeoutMillis=parseInt(t.acquireTimeoutMillis,10)),void 0!==t.maxWaitingClients&&(this.maxWaitingClients=parseInt(t.maxWaitingClients,10)),this.max=parseInt(t.max,10),this.min=parseInt(t.min,10),this.max=Math.max(isNaN(this.max)?1:this.max,1),this.min=Math.min(isNaN(this.min)?0:this.min,this.max),this.evictionRunIntervalMillis=t.evictionRunIntervalMillis||e.evictionRunIntervalMillis,this.numTestsPerEvictionRun=t.numTestsPerEvictionRun||e.numTestsPerEvictionRun,this.softIdleTimeoutMillis=t.softIdleTimeoutMillis||e.softIdleTimeoutMillis,this.idleTimeoutMillis=t.idleTimeoutMillis||e.idleTimeoutMillis,this.Promise=null!=t.Promise?t.Promise:e.Promise}}},function(t,e,s){"use strict";t.exports=class{constructor(){this.fifo=!0,this.priorityRange=1,this.testOnBorrow=!1,this.testOnReturn=!1,this.autostart=!0,this.evictionRunIntervalMillis=0,this.numTestsPerEvictionRun=3,this.softIdleTimeoutMillis=-1,this.idleTimeoutMillis=3e4,this.acquireTimeoutMillis=null,this.maxWaitingClients=null,this.min=null,this.max=null,this.Promise=Promise}}},function(t,e,s){"use strict";const i=s(18),r=s(39);class n extends i{constructor(t,e){super(e),this._creationTimestamp=Date.now(),this._timeout=null,void 0!==t&&this.setTimeout(t)}setTimeout(t){if(this._state!==n.PENDING)return;const e=parseInt(t,10);if(isNaN(e)||e<=0)throw new Error("delay must be a positive int");const s=Date.now()-this._creationTimestamp;var i,r;this._timeout&&this.removeTimeout(),this._timeout=setTimeout((i=this._fireTimeout,r=this,function(){return i.apply(r,arguments)}),Math.max(e-s,0))}removeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=null}_fireTimeout(){this.reject(new r.TimeoutError("ResourceRequest timed out"))}reject(t){this.removeTimeout(),super.reject(t)}resolve(t){this.removeTimeout(),super.resolve(t)}}t.exports=n},function(t,e,s){"use strict";class i extends Error{constructor(t){super(t),this.name=this.constructor.name,this.message=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(t).stack}}t.exports={TimeoutError:class extends i{constructor(t){super(t)}}}},function(t,e,s){"use strict";const i=s(18);t.exports=class extends i{constructor(t,e){super(e),this._creationTimestamp=Date.now(),this.pooledResource=t}reject(){}}},function(t,e,s){"use strict";const i=s(42);t.exports=class{constructor(t){this.creationTime=Date.now(),this.lastReturnTime=null,this.lastBorrowTime=null,this.lastIdleTime=null,this.obj=t,this.state=i.IDLE}allocate(){this.lastBorrowTime=Date.now(),this.state=i.ALLOCATED}deallocate(){this.lastReturnTime=Date.now(),this.state=i.IDLE}invalidate(){this.state=i.INVALID}test(){this.state=i.VALIDATION}idle(){this.lastIdleTime=Date.now(),this.state=i.IDLE}returning(){this.state=i.RETURNING}}},function(t,e,s){"use strict";t.exports={ALLOCATED:"ALLOCATED",IDLE:"IDLE",INVALID:"INVALID",RETURNING:"RETURNING",VALIDATION:"VALIDATION"}},function(t,e,s){"use strict";t.exports=class{constructor(t,e){this._list=t,this._direction=!0===e?"prev":"next",this._startPosition=!0===e?"tail":"head",this._started=!1,this._cursor=null,this._done=!1}_start(){this._cursor=this._list[this._startPosition],this._started=!0}_advanceCursor(){if(!1===this._started)return this._started=!0,void(this._cursor=this._list[this._startPosition]);this._cursor=this._cursor[this._direction]}reset(){this._done=!1,this._started=!1,this._cursor=null}remove(){if(!1===this._started||!0===this._done||this._isCursorDetached())return!1;this._list.remove(this._cursor)}next(){return!0===this._done?{done:!0}:(this._advanceCursor(),null===this._cursor||this._isCursorDetached()?(this._done=!0,{done:!0}):{value:this._cursor,done:!1})}_isCursorDetached(){return null===this._cursor.prev&&null===this._cursor.next&&this._list.tail!==this._cursor&&this._list.head!==this._cursor}}},function(t,e,s){"use strict";const i=s(24),r=s(19);t.exports=class extends r{push(t){const e=i.createNode(t);t.promise.catch(this._createTimeoutRejectionHandler(e)),this._list.insertEnd(e)}_createTimeoutRejectionHandler(t){return e=>{"TimeoutError"===e.name&&this._list.remove(t)}}}},function(t,e,s){"use strict";function i(){}e.reflector=function(t){return t.then(i,i)}},function(t,e){t.exports=class extends Error{constructor(){super(),this.status=400,this.children=[]}get message(){return this.children.map(t=>t.message).join(", ")}add(t){this.children.push(t)}empty(){return 0===this.children.length}}},function(t,e,s){"use strict";t.exports=function(t){if(!Array.isArray(t))throw new TypeError("Middleware stack must be an array!");for(const e of t)if("function"!=typeof e)throw new TypeError("Middleware must be composed of functions!");return function(e,s){let i=-1;return function r(n){if(n<=i)return Promise.reject(new Error("next() called multiple times"));i=n;let o=t[n];n===t.length&&(o=s);if(!o)return Promise.resolve();try{return Promise.resolve(o(e,r.bind(null,n+1)))}catch(t){return Promise.reject(t)}}(0)}}},function(t,e,s){const i=s(29),r=new(s(49));let n=0;t.exports=class{constructor({manager:t,options:e={}}){this.id=`session-${n++}`,this.manager=t,this.connections={},this.state=Object.assign({},e.state)}factory(t,e){return new i({session:this,schema:t,criteria:e})}async acquire(t){let e=this.manager.getPool(t);if(!this.connections[e.name]){let t=`${this.id}-${e.name}`;this.connections[e.name]=await r.singleton(t,()=>e.acquire()),await this.connections[e.name].begin()}return this.connections[e.name]}async dispose(){await this.rollback(),await Promise.all(Object.keys(this.connections).map(t=>this.manager.getPool(t).release(this.connections[t]))),this.connections={}}close(){return this.commit()}async commit(){await Promise.all(Object.keys(this.connections).map(async t=>{let e=this.connections[t];await e.commit()}))}async rollback(){await Promise.all(Object.keys(this.connections).map(async t=>{let e=this.connections[t];await e.rollback()}))}async begin(){await Promise.all(Object.keys(this.connections).map(async t=>{let e=this.connections[t];await e.begin()}))}async flush(){await this.commit(),await this.begin()}parseSchema(t){let e,s;if(Array.isArray(t)){if(t.length<2)throw new Error("Malformed schema name tupple");[e,s]=t}else-1!==t.indexOf(".")?[e,s]=t.split("."):(e=this.manager.getPool().name,s=t);let i=this.manager.getPool(e);return[i.name,i.getSchema(s)]}}},function(t,e){class s{constructor(t){this.fn=t,this.locks=[],this.done=!1}async fetch(){if(this.done||await new Promise(async(t,e)=>{if(this.locks.push([t,e]),!(this.locks.length>1)){try{let{fn:t}=this;this.value=await t()}catch(t){this.error=t}this.done=!0,this.locks.splice(0).forEach(([t,e])=>{this.error?e(this.error):t(this.value)})}}),this.error)throw this.error;return this.value}}t.exports=class{constructor(){this.spaces=new Map}async singleton(t,e){let i;return e=e||t,this.spaces.has(t)?i=this.spaces.get(t):(i=new s(e),this.spaces.set(t,i)),i.fetch()}}},function(t,e,s){t.exports={NBoolean:s(51),NDatetime:s(20),NDouble:s(52),NField:s(0),NInteger:s(53),NReference:s(54),NString:s(21),NText:s(55),NList:s(56),NMap:s(57),NBig:s(58)}},function(t,e,s){const i=s(0);t.exports=class extends i{attach(t){return null==t?null:"false"!==t&&"0"!==t&&""!==t&&Boolean(t)}}},function(t,e,s){const i=s(0);t.exports=class extends i{attach(t){if(null===(t=super.attach(t)))return null;if(t=parseFloat(t),isNaN(t))throw new Error("Invalid double value");return t}compare(t,e){return void 0===e&&(e=null),t===e?0:null===t?1:e-t}}},function(t,e,s){const i=s(0);t.exports=class extends i{attach(t){if(null===(t=super.attach(t)))return null;if(t=parseInt(t,10),isNaN(t))throw new Error("Invalid integer value");return t}compare(t,e){return void 0===e&&(e=null),t===e?0:null===t?1:e-t}}},function(t,e,s){const i=s(0);t.exports=class extends i{to(t){return this.to=t,this}}},function(t,e,s){const i=s(0);t.exports=class extends i{}},function(t,e,s){const i=s(0);t.exports=class extends i{of(t){return this.childField=t,this}attach(t){if(null===(t=super.attach(t)))return null;if("string"==typeof t)try{t=JSON.parse(t)}catch(t){throw new Error("Invalid list value")}if(!Array.isArray(t))throw new Error("Invalid list value");return this.childField&&(t=t.map(t=>this.childField.attach(t))),t}}},function(t,e,s){const i=s(0);t.exports=class extends i{attach(t){if(null===(t=super.attach(t)))return null;if("string"==typeof t)try{t=JSON.parse(t)}catch(t){throw new Error("Invalid map value")}if("object"!=typeof t||Array.isArray(t))throw new Error("Invalid map value");return t}compare(t,e){if(void 0===e&&(e=null),t===e)return 0;if(null===t)return 1;let s=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(e);if(s.length!==i.length)return 1;for(let r of s){if(!i.includes(r))return 1;if(t[r]!==e[r])return 1}return 0}}},function(t,e,s){const i=s(0),r=s(59);t.exports=class extends i{attach(t){if(null===(t=super.attach(t)))return null;try{return new r(t)}catch(t){throw new Error("Invalid big value")}}compare(t,e){return void 0===e&&(e=null),t===e?0:null===t?1:new r(e).cmp(t)}serialize(t){return null===t?t:t.toJSON()}}},function(t,e,s){var i;!function(r){"use strict";var n,o=20,a=1,c=1e6,l=-7,u=21,h="[big.js] ",f=h+"Invalid ",d=f+"decimal places",m=f+"rounding mode",p={},v=void 0,_=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function w(t,e,s,i){var r=t.c,n=t.e+e+1;if(n<r.length){if(1===s)i=r[n]>=5;else if(2===s)i=r[n]>5||5==r[n]&&(i||n<0||r[n+1]!==v||1&r[n-1]);else if(3===s)i=i||!!r[0];else if(i=!1,0!==s)throw Error(m);if(n<1)r.length=1,i?(t.e=-e,r[0]=1):r[0]=t.e=0;else{if(r.length=n--,i)for(;++r[n]>9;)r[n]=0,n--||(++t.e,r.unshift(1));for(n=r.length;!r[--n];)r.pop()}}else if(s<0||s>3||s!==~~s)throw Error(m);return t}function g(t,e,s,i){var r,n,o=t.constructor,a=!t.c[0];if(s!==v){if(s!==~~s||s<(3==e)||s>c)throw Error(3==e?f+"precision":d);for(s=i-(t=new o(t)).e,t.c.length>++i&&w(t,s,o.RM),2==e&&(i=t.e+s+1);t.c.length<i;)t.c.push(0)}if(r=t.e,s=(n=t.c.join("")).length,2!=e&&(1==e||3==e&&i<=r||r<=o.NE||r>=o.PE))n=n.charAt(0)+(s>1?"."+n.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)n="0"+n;n="0."+n}else if(r>0)if(++r>s)for(r-=s;r--;)n+="0";else r<s&&(n=n.slice(0,r)+"."+n.slice(r));else s>1&&(n=n.charAt(0)+"."+n.slice(1));return t.s<0&&(!a||4==e)?"-"+n:n}p.abs=function(){var t=new this.constructor(this);return t.s=1,t},p.cmp=function(t){var e,s=this,i=s.c,r=(t=new s.constructor(t)).c,n=s.s,o=t.s,a=s.e,c=t.e;if(!i[0]||!r[0])return i[0]?n:r[0]?-o:0;if(n!=o)return n;if(e=n<0,a!=c)return a>c^e?1:-1;for(o=(a=i.length)<(c=r.length)?a:c,n=-1;++n<o;)if(i[n]!=r[n])return i[n]>r[n]^e?1:-1;return a==c?0:a>c^e?1:-1},p.div=function(t){var e=this,s=e.constructor,i=e.c,r=(t=new s(t)).c,n=e.s==t.s?1:-1,o=s.DP;if(o!==~~o||o<0||o>c)throw Error(d);if(!r[0])throw Error("[big.js] Division by zero");if(!i[0])return new s(0*n);var a,l,u,h,f,m=r.slice(),p=a=r.length,_=i.length,g=i.slice(0,a),y=g.length,b=t,x=b.c=[],E=0,O=o+(b.e=e.e-t.e)+1;for(b.s=n,n=O<0?0:O,m.unshift(0);y++<a;)g.push(0);do{for(u=0;u<10;u++){if(a!=(y=g.length))h=a>y?1:-1;else for(f=-1,h=0;++f<a;)if(r[f]!=g[f]){h=r[f]>g[f]?1:-1;break}if(!(h<0))break;for(l=y==a?r:m;y;){if(g[--y]<l[y]){for(f=y;f&&!g[--f];)g[f]=9;--g[f],g[y]+=10}g[y]-=l[y]}for(;!g[0];)g.shift()}x[E++]=h?u:++u,g[0]&&h?g[y]=i[p]||0:g=[i[p]]}while((p++<_||g[0]!==v)&&n--);return x[0]||1==E||(x.shift(),b.e--),E>O&&w(b,o,s.RM,g[0]!==v),b},p.eq=function(t){return!this.cmp(t)},p.gt=function(t){return this.cmp(t)>0},p.gte=function(t){return this.cmp(t)>-1},p.lt=function(t){return this.cmp(t)<0},p.lte=function(t){return this.cmp(t)<1},p.minus=p.sub=function(t){var e,s,i,r,n=this,o=n.constructor,a=n.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,n.plus(t);var l=n.c.slice(),u=n.e,h=t.c,f=t.e;if(!l[0]||!h[0])return h[0]?(t.s=-c,t):new o(l[0]?n:0);if(a=u-f){for((r=a<0)?(a=-a,i=l):(f=u,i=h),i.reverse(),c=a;c--;)i.push(0);i.reverse()}else for(s=((r=l.length<h.length)?l:h).length,a=c=0;c<s;c++)if(l[c]!=h[c]){r=l[c]<h[c];break}if(r&&(i=l,l=h,h=i,t.s=-t.s),(c=(s=h.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;s>a;){if(l[--s]<h[s]){for(e=s;e&&!l[--e];)l[e]=9;--l[e],l[s]+=10}l[s]-=h[s]}for(;0===l[--c];)l.pop();for(;0===l[0];)l.shift(),--f;return l[0]||(t.s=1,l=[f=0]),t.c=l,t.e=f,t},p.mod=function(t){var e,s=this,i=s.constructor,r=s.s,n=(t=new i(t)).s;if(!t.c[0])throw Error("[big.js] Division by zero");return s.s=t.s=1,e=1==t.cmp(s),s.s=r,t.s=n,e?new i(s):(r=i.DP,n=i.RM,i.DP=i.RM=0,s=s.div(t),i.DP=r,i.RM=n,this.minus(s.times(t)))},p.plus=p.add=function(t){var e,s=this,i=s.constructor,r=s.s,n=(t=new i(t)).s;if(r!=n)return t.s=-n,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]?t:new i(a[0]?s:0*r);if(a=a.slice(),r=o-c){for(r>0?(c=o,e=l):(r=-r,e=a),e.reverse();r--;)e.push(0);e.reverse()}for(a.length-l.length<0&&(e=l,l=a,a=e),r=l.length,n=0;r;a[r]%=10)n=(a[--r]=a[r]+l[r]+n)/10|0;for(n&&(a.unshift(n),++c),r=a.length;0===a[--r];)a.pop();return t.c=a,t.e=c,t},p.pow=function(t){var e=this,s=new e.constructor(1),i=s,r=t<0;if(t!==~~t||t<-1e6||t>1e6)throw Error(f+"exponent");for(r&&(t=-t);1&t&&(i=i.times(e)),t>>=1;)e=e.times(e);return r?s.div(i):i},p.round=function(t,e){var s=this.constructor;if(t===v)t=0;else if(t!==~~t||t<-c||t>c)throw Error(d);return w(new s(this),t,e===v?s.RM:e)},p.sqrt=function(){var t,e,s,i=this,r=i.constructor,n=i.s,o=i.e,a=new r(.5);if(!i.c[0])return new r(i);if(n<0)throw Error(h+"No square root");0===(n=Math.sqrt(i+""))||n===1/0?((e=i.c.join("")).length+o&1||(e+="0"),o=((o+1)/2|0)-(o<0||1&o),t=new r(((n=Math.sqrt(e))==1/0?"1e":(n=n.toExponential()).slice(0,n.indexOf("e")+1))+o)):t=new r(n),o=t.e+(r.DP+=4);do{s=t,t=a.times(s.plus(i.div(s)))}while(s.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return w(t,r.DP-=4,r.RM)},p.times=p.mul=function(t){var e,s=this,i=s.constructor,r=s.c,n=(t=new i(t)).c,o=r.length,a=n.length,c=s.e,l=t.e;if(t.s=s.s==t.s?1:-1,!r[0]||!n[0])return new i(0*t.s);for(t.e=c+l,o<a&&(e=r,r=n,n=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+n[c]*r[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=(e[l]+a)%10}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t},p.toExponential=function(t){return g(this,1,t,t)},p.toFixed=function(t){return g(this,2,t,this.e+t)},p.toPrecision=function(t){return g(this,3,t,t-1)},p.toString=function(){return g(this)},p.valueOf=p.toJSON=function(){return g(this,4)},(n=function t(){function e(s){var i=this;if(!(i instanceof e))return s===v?t():new e(s);s instanceof e?(i.s=s.s,i.e=s.e,i.c=s.c.slice()):function(t,e){var s,i,r;if(0===e&&1/e<0)e="-0";else if(!_.test(e+=""))throw Error(f+"number");for(t.s="-"==e.charAt(0)?(e=e.slice(1),-1):1,(s=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(s<0&&(s=i),s+=+e.slice(i+1),e=e.substring(0,i)):s<0&&(s=e.length),r=e.length,i=0;i<r&&"0"==e.charAt(i);)++i;if(i==r)t.c=[t.e=0];else{for(;r>0&&"0"==e.charAt(--r););for(t.e=s-i-1,t.c=[],s=0;i<=r;)t.c[s++]=+e.charAt(i++)}}(i,s),i.constructor=e}return e.prototype=p,e.DP=o,e.RM=a,e.NE=l,e.PE=u,e.version="5.2.2",e}()).default=n.Big=n,void 0===(i=function(){return n}.call(e,s,e,t))||(t.exports=i)}()}]);
//# sourceMappingURL=norm.min.js.map